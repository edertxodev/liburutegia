<%= form_for @user, :action => 'update' do |f| %>
  <%= devise_error_messages! %>
  
    <h2 class="page-header">Editar avatar</h2>
  
    <div class="col-sm-3 col-sm-offset-4">
        <div class="row text-center">
            <% if @user.avatar? %>
                <%= image_tag @user.avatar, :class => 'img-responsive img-circle img-thumbnail avatar' %>
            <% else %>
                <img src="/uploads/user/avatar/sinusuario.png" class="img-responsive img-circle img-thumbnail avatar" />
            <% end %>
        </div>
        <% if current_user.username == @user.username %>
            <div class="row">
                <h4>Cambiar imagen</h4>
                <%= f.file_field :avatar %>            
            </div>
        <% end %>
        <% if current_user.role == 'admin' %>
            <div class="row">
                <h4>Cambiar nombre de usuario</h4>
                <%= f.text_field :username, :class => 'form-control' %>
            </div>
            <div class="row">
                <h4>Cambiar rol</h4>
                <%= f.collection_select(:role, User::ROLES, :to_s, lambda{|i| i.to_s.humanize}) %>
            </div>
        <% end %>
        <% if current_user.role == 'admin' && current_user.username != @user.username %>
            <div class="row">
                <h4>Cambiar contraseÃ±a</h4>
                <small>Introduce una nueva contraseÃ±a si lo deseas</small>
                <%= f.text_field :password, autocomplete: "off", :class => 'form-control' %>
            </div>
        <% end %>
          <div class="text-center">
            <%= f.submit 'Guardar', :class => 'btn btn-primary' %>
            <%= link_to 'Cancelar', @user, :class => 'btn btn-default' %>
          </div>
    </div>
<% end %>